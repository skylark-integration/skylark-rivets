{"version":3,"sources":["bindings.js"],"names":["define","Rivets","__extends","child","parent","key","__hasProp","call","ctor","this","constructor","prototype","__super__","hasOwnProperty","__slice","slice","__indexOf","indexOf","__bind","fn","me","apply","arguments","Binding","view","el","type","keypath","options","getValue","update","unbind","bind","publish","sync","set","eventHandler","formattedValue","parseFormatterArguments","parseTarget","observe","setBinder","formatters","dependencies","formatterObservers","model","identifier","value","_ref1","binder","binders","RegExp","replace","test","args","exec","shift","Function","routine","obj","callback","sightglass","root","rootInterface","adapters","token","TypeParser","parse","types","primitive","observer","models","target","formatterIndex","ai","arg","processedArgs","_base","_i","_len","_results","length","push","fi","formatter","id","_ref2","match","read","concat","binding","handler","ev","executeFunctions","dependency","_j","_len1","_ref3","unobserve","fiReversed","lastformatterIndex","reverse","split","setValue","preloadData","_ref4","Util","getInputValue","ComponentBinding","_super","attribute","bindingRegExp","propertyName","locals","component","components","observers","upstreamObservers","attributes","name","camelCase","result","string","grouped","toUpperCase","k","option","scope","v","_ref5","_ref6","_ref7","bound","_this","componentView","innerHTML","template","initialize","_bound","extensions","View","Array","childNodes","TextBinding","node","data"],"mappings":"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","file":"../bindings.js","sourcesContent":["define([\r\n  \"./rivets\",\r\n  \"./sightglass\",\r\n  \"./util\",\r\n  \"./parsers\",\r\n  \"./views\"\r\n],function(Rivets){\r\n\r\n  var __extends = function(child, parent) { \r\n    for (var key in parent) { \r\n      if (__hasProp.call(parent, key)) \r\n        child[key] = parent[key]; \r\n    } \r\n    function ctor() { \r\n      this.constructor = child; \r\n    } \r\n    ctor.prototype = parent.prototype; \r\n    child.prototype = new ctor(); \r\n    child.__super__ = parent.prototype; \r\n    return child; \r\n  },__hasProp = {}.hasOwnProperty,\r\n    __slice = [].slice,\r\n    __indexOf = [].indexOf,\r\n    __bind = function(fn, me){ \r\n      return function(){ \r\n        return fn.apply(me, arguments); }; \r\n    };\r\n\r\n\r\n  Rivets.Binding = (function() {\r\n    function Binding(view, el, type, keypath, options) {\r\n      this.view = view;\r\n      this.el = el;\r\n      this.type = type;\r\n      this.keypath = keypath;\r\n      this.options = options != null ? options : {};\r\n      this.getValue = __bind(this.getValue, this);\r\n      this.update = __bind(this.update, this);\r\n      this.unbind = __bind(this.unbind, this);\r\n      this.bind = __bind(this.bind, this);\r\n      this.publish = __bind(this.publish, this);\r\n      this.sync = __bind(this.sync, this);\r\n      this.set = __bind(this.set, this);\r\n      this.eventHandler = __bind(this.eventHandler, this);\r\n      this.formattedValue = __bind(this.formattedValue, this);\r\n      this.parseFormatterArguments = __bind(this.parseFormatterArguments, this);\r\n      this.parseTarget = __bind(this.parseTarget, this);\r\n      this.observe = __bind(this.observe, this);\r\n      this.setBinder = __bind(this.setBinder, this);\r\n      this.formatters = this.options.formatters || [];\r\n      this.dependencies = [];\r\n      this.formatterObservers = {};\r\n      this.model = void 0;\r\n      this.setBinder();\r\n    }\r\n\r\n    Binding.prototype.setBinder = function() {\r\n      var identifier, regexp, value, _ref1;\r\n      if (!(this.binder = this.view.binders[this.type])) {\r\n        _ref1 = this.view.binders;\r\n        for (identifier in _ref1) {\r\n          value = _ref1[identifier];\r\n          if (identifier !== '*' && identifier.indexOf('*') !== -1) {\r\n            regexp = new RegExp(\"^\" + (identifier.replace(/\\*/g, '.+')) + \"$\");\r\n            if (regexp.test(this.type)) {\r\n              this.binder = value;\r\n              this.args = new RegExp(\"^\" + (identifier.replace(/\\*/g, '(.+)')) + \"$\").exec(this.type);\r\n              this.args.shift();\r\n            }\r\n          }\r\n        }\r\n      }\r\n      this.binder || (this.binder = this.view.binders['*']);\r\n      if (this.binder instanceof Function) {\r\n        return this.binder = {\r\n          routine: this.binder\r\n        };\r\n      }\r\n    };\r\n\r\n    Binding.prototype.observe = function(obj, keypath, callback) {\r\n      return Rivets.sightglass(obj, keypath, callback, {\r\n        root: this.view.rootInterface,\r\n        adapters: this.view.adapters\r\n      });\r\n    };\r\n\r\n    Binding.prototype.parseTarget = function() {\r\n      var token;\r\n      token = Rivets.TypeParser.parse(this.keypath);\r\n      if (token.type === Rivets.TypeParser.types.primitive) {\r\n        return this.value = token.value;\r\n      } else {\r\n        this.observer = this.observe(this.view.models, this.keypath, this.sync);\r\n        return this.model = this.observer.target;\r\n      }\r\n    };\r\n\r\n    Binding.prototype.parseFormatterArguments = function(args, formatterIndex) {\r\n      var ai, arg, observer, processedArgs, _base, _i, _len;\r\n      args = (function() {\r\n        var _i, _len, _results;\r\n        _results = [];\r\n        for (_i = 0, _len = args.length; _i < _len; _i++) {\r\n          arg = args[_i];\r\n          _results.push(Rivets.TypeParser.parse(arg));\r\n        }\r\n        return _results;\r\n      })();\r\n      processedArgs = [];\r\n      for (ai = _i = 0, _len = args.length; _i < _len; ai = ++_i) {\r\n        arg = args[ai];\r\n        processedArgs.push(arg.type === Rivets.TypeParser.types.primitive ? arg.value : ((_base = this.formatterObservers)[formatterIndex] || (_base[formatterIndex] = {}), !(observer = this.formatterObservers[formatterIndex][ai]) ? (observer = this.observe(this.view.models, arg.value, this.sync), this.formatterObservers[formatterIndex][ai] = observer) : void 0, observer.value()));\r\n      }\r\n      return processedArgs;\r\n    };\r\n\r\n    Binding.prototype.formattedValue = function(value) {\r\n      var args, fi, formatter, id, processedArgs, _i, _len, _ref1, _ref2;\r\n      _ref1 = this.formatters;\r\n      for (fi = _i = 0, _len = _ref1.length; _i < _len; fi = ++_i) {\r\n        formatter = _ref1[fi];\r\n        args = formatter.match(/[^\\s']+|'([^']|'[^\\s])*'|\"([^\"]|\"[^\\s])*\"/g);\r\n        id = args.shift();\r\n        formatter = this.view.formatters[id];\r\n        processedArgs = this.parseFormatterArguments(args, fi);\r\n        if ((formatter != null ? formatter.read : void 0) instanceof Function) {\r\n          value = (_ref2 = formatter.read).call.apply(_ref2, [this.model, value].concat(__slice.call(processedArgs)));\r\n        } else if (formatter instanceof Function) {\r\n          value = formatter.call.apply(formatter, [this.model, value].concat(__slice.call(processedArgs)));\r\n        }\r\n      }\r\n      return value;\r\n    };\r\n\r\n    Binding.prototype.eventHandler = function(fn) {\r\n      var binding, handler;\r\n      handler = (binding = this).view.handler;\r\n      return function(ev) {\r\n        return handler.call(fn, this, ev, binding);\r\n      };\r\n    };\r\n\r\n    Binding.prototype.set = function(value) {\r\n      var _ref1;\r\n      value = value instanceof Function && !this.binder[\"function\"] && Rivets[\"public\"].executeFunctions ? this.formattedValue(value.call(this.model)) : this.formattedValue(value);\r\n      return (_ref1 = this.binder.routine) != null ? _ref1.call(this, this.el, value) : void 0;\r\n    };\r\n\r\n    Binding.prototype.sync = function() {\r\n      var dependency, observer;\r\n      return this.set((function() {\r\n        var _i, _j, _len, _len1, _ref1, _ref2, _ref3;\r\n        if (this.observer) {\r\n          if (this.model !== this.observer.target) {\r\n            _ref1 = this.dependencies;\r\n            for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\r\n              observer = _ref1[_i];\r\n              observer.unobserve();\r\n            }\r\n            this.dependencies = [];\r\n            if (((this.model = this.observer.target) != null) && ((_ref2 = this.options.dependencies) != null ? _ref2.length : void 0)) {\r\n              _ref3 = this.options.dependencies;\r\n              for (_j = 0, _len1 = _ref3.length; _j < _len1; _j++) {\r\n                dependency = _ref3[_j];\r\n                observer = this.observe(this.model, dependency, this.sync);\r\n                this.dependencies.push(observer);\r\n              }\r\n            }\r\n          }\r\n          return this.observer.value();\r\n        } else {\r\n          return this.value;\r\n        }\r\n      }).call(this));\r\n    };\r\n\r\n    Binding.prototype.publish = function() {\r\n      var args, fi, fiReversed, formatter, id, lastformatterIndex, processedArgs, value, _i, _len, _ref1, _ref2, _ref3;\r\n      if (this.observer) {\r\n        value = this.getValue(this.el);\r\n        lastformatterIndex = this.formatters.length - 1;\r\n        _ref1 = this.formatters.slice(0).reverse();\r\n        for (fiReversed = _i = 0, _len = _ref1.length; _i < _len; fiReversed = ++_i) {\r\n          formatter = _ref1[fiReversed];\r\n          fi = lastformatterIndex - fiReversed;\r\n          args = formatter.split(/\\s+/);\r\n          id = args.shift();\r\n          processedArgs = this.parseFormatterArguments(args, fi);\r\n          if ((_ref2 = this.view.formatters[id]) != null ? _ref2.publish : void 0) {\r\n            value = (_ref3 = this.view.formatters[id]).publish.apply(_ref3, [value].concat(__slice.call(processedArgs)));\r\n          }\r\n        }\r\n        return this.observer.setValue(value);\r\n      }\r\n    };\r\n\r\n    Binding.prototype.bind = function() {\r\n      var dependency, observer, _i, _len, _ref1, _ref2, _ref3;\r\n      this.parseTarget();\r\n      if ((_ref1 = this.binder.bind) != null) {\r\n        _ref1.call(this, this.el);\r\n      }\r\n      if ((this.model != null) && ((_ref2 = this.options.dependencies) != null ? _ref2.length : void 0)) {\r\n        _ref3 = this.options.dependencies;\r\n        for (_i = 0, _len = _ref3.length; _i < _len; _i++) {\r\n          dependency = _ref3[_i];\r\n          observer = this.observe(this.model, dependency, this.sync);\r\n          this.dependencies.push(observer);\r\n        }\r\n      }\r\n      if (this.view.preloadData) {\r\n        return this.sync();\r\n      }\r\n    };\r\n\r\n    Binding.prototype.unbind = function() {\r\n      var ai, args, fi, observer, _i, _len, _ref1, _ref2, _ref3, _ref4;\r\n      if ((_ref1 = this.binder.unbind) != null) {\r\n        _ref1.call(this, this.el);\r\n      }\r\n      if ((_ref2 = this.observer) != null) {\r\n        _ref2.unobserve();\r\n      }\r\n      _ref3 = this.dependencies;\r\n      for (_i = 0, _len = _ref3.length; _i < _len; _i++) {\r\n        observer = _ref3[_i];\r\n        observer.unobserve();\r\n      }\r\n      this.dependencies = [];\r\n      _ref4 = this.formatterObservers;\r\n      for (fi in _ref4) {\r\n        args = _ref4[fi];\r\n        for (ai in args) {\r\n          observer = args[ai];\r\n          observer.unobserve();\r\n        }\r\n      }\r\n      return this.formatterObservers = {};\r\n    };\r\n\r\n    Binding.prototype.update = function(models) {\r\n      var _ref1, _ref2;\r\n      if (models == null) {\r\n        models = {};\r\n      }\r\n      this.model = (_ref1 = this.observer) != null ? _ref1.target : void 0;\r\n      return (_ref2 = this.binder.update) != null ? _ref2.call(this, models) : void 0;\r\n    };\r\n\r\n    Binding.prototype.getValue = function(el) {\r\n      if (this.binder && (this.binder.getValue != null)) {\r\n        return this.binder.getValue.call(this, el);\r\n      } else {\r\n        return Rivets.Util.getInputValue(el);\r\n      }\r\n    };\r\n\r\n    return Binding;\r\n\r\n  })();\r\n\r\n  Rivets.ComponentBinding = (function(_super) {\r\n    __extends(ComponentBinding, _super);\r\n\r\n    function ComponentBinding(view, el, type) {\r\n      var attribute, bindingRegExp, propertyName, token, _i, _len, _ref1, _ref2;\r\n      this.view = view;\r\n      this.el = el;\r\n      this.type = type;\r\n      this.unbind = __bind(this.unbind, this);\r\n      this.bind = __bind(this.bind, this);\r\n      this.locals = __bind(this.locals, this);\r\n      this.component = this.view.components[this.type];\r\n      this[\"static\"] = {};\r\n      this.observers = {};\r\n      this.upstreamObservers = {};\r\n      bindingRegExp = view.bindingRegExp();\r\n      _ref1 = this.el.attributes || [];\r\n      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\r\n        attribute = _ref1[_i];\r\n        if (!bindingRegExp.test(attribute.name)) {\r\n          propertyName = this.camelCase(attribute.name);\r\n          token = Rivets.TypeParser.parse(attribute.value);\r\n          if (__indexOf.call((_ref2 = this.component[\"static\"]) != null ? _ref2 : [], propertyName) >= 0) {\r\n            this[\"static\"][propertyName] = attribute.value;\r\n          } else if (token.type === Rivets.TypeParser.types.primitive) {\r\n            this[\"static\"][propertyName] = token.value;\r\n          } else {\r\n            this.observers[propertyName] = attribute.value;\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n    ComponentBinding.prototype.sync = function() {};\r\n\r\n    ComponentBinding.prototype.update = function() {};\r\n\r\n    ComponentBinding.prototype.publish = function() {};\r\n\r\n    ComponentBinding.prototype.locals = function() {\r\n      var key, observer, result, value, _ref1, _ref2;\r\n      result = {};\r\n      _ref1 = this[\"static\"];\r\n      for (key in _ref1) {\r\n        value = _ref1[key];\r\n        result[key] = value;\r\n      }\r\n      _ref2 = this.observers;\r\n      for (key in _ref2) {\r\n        observer = _ref2[key];\r\n        result[key] = observer.value();\r\n      }\r\n      return result;\r\n    };\r\n\r\n    ComponentBinding.prototype.camelCase = function(string) {\r\n      return string.replace(/-([a-z])/g, function(grouped) {\r\n        return grouped[1].toUpperCase();\r\n      });\r\n    };\r\n\r\n    ComponentBinding.prototype.bind = function() {\r\n      var k, key, keypath, observer, option, options, scope, v, _base, _i, _j, _len, _len1, _ref1, _ref2, _ref3, _ref4, _ref5, _ref6, _ref7;\r\n      if (!this.bound) {\r\n        _ref1 = this.observers;\r\n        for (key in _ref1) {\r\n          keypath = _ref1[key];\r\n          this.observers[key] = this.observe(this.view.models, keypath, ((function(_this) {\r\n            return function(key) {\r\n              return function() {\r\n                return _this.componentView.models[key] = _this.observers[key].value();\r\n              };\r\n            };\r\n          })(this)).call(this, key));\r\n        }\r\n        this.bound = true;\r\n      }\r\n      if (this.componentView != null) {\r\n        this.componentView.bind();\r\n      } else {\r\n        this.el.innerHTML = this.component.template.call(this);\r\n        scope = this.component.initialize.call(this, this.el, this.locals());\r\n        this.el._bound = true;\r\n        options = {};\r\n        _ref2 = Rivets.extensions;\r\n        for (_i = 0, _len = _ref2.length; _i < _len; _i++) {\r\n          option = _ref2[_i];\r\n          options[option] = {};\r\n          if (this.component[option]) {\r\n            _ref3 = this.component[option];\r\n            for (k in _ref3) {\r\n              v = _ref3[k];\r\n              options[option][k] = v;\r\n            }\r\n          }\r\n          _ref4 = this.view[option];\r\n          for (k in _ref4) {\r\n            v = _ref4[k];\r\n            if ((_base = options[option])[k] == null) {\r\n              _base[k] = v;\r\n            }\r\n          }\r\n        }\r\n        _ref5 = Rivets.options;\r\n        for (_j = 0, _len1 = _ref5.length; _j < _len1; _j++) {\r\n          option = _ref5[_j];\r\n          options[option] = (_ref6 = this.component[option]) != null ? _ref6 : this.view[option];\r\n        }\r\n        this.componentView = new Rivets.View(Array.prototype.slice.call(this.el.childNodes), scope, options);\r\n        this.componentView.bind();\r\n        _ref7 = this.observers;\r\n        for (key in _ref7) {\r\n          observer = _ref7[key];\r\n          this.upstreamObservers[key] = this.observe(this.componentView.models, key, ((function(_this) {\r\n            return function(key, observer) {\r\n              return function() {\r\n                return observer.setValue(_this.componentView.models[key]);\r\n              };\r\n            };\r\n          })(this)).call(this, key, observer));\r\n        }\r\n      }\r\n    };\r\n\r\n    ComponentBinding.prototype.unbind = function() {\r\n      var key, observer, _ref1, _ref2, _ref3;\r\n      _ref1 = this.upstreamObservers;\r\n      for (key in _ref1) {\r\n        observer = _ref1[key];\r\n        observer.unobserve();\r\n      }\r\n      _ref2 = this.observers;\r\n      for (key in _ref2) {\r\n        observer = _ref2[key];\r\n        observer.unobserve();\r\n      }\r\n      return (_ref3 = this.componentView) != null ? _ref3.unbind.call(this) : void 0;\r\n    };\r\n\r\n    return ComponentBinding;\r\n\r\n  })(Rivets.Binding);\r\n\r\n  Rivets.TextBinding = (function(_super) {\r\n    __extends(TextBinding, _super);\r\n\r\n    function TextBinding(view, el, type, keypath, options) {\r\n      this.view = view;\r\n      this.el = el;\r\n      this.type = type;\r\n      this.keypath = keypath;\r\n      this.options = options != null ? options : {};\r\n      this.sync = __bind(this.sync, this);\r\n      this.formatters = this.options.formatters || [];\r\n      this.dependencies = [];\r\n      this.formatterObservers = {};\r\n    }\r\n\r\n    TextBinding.prototype.binder = {\r\n      routine: function(node, value) {\r\n        return node.data = value != null ? value : '';\r\n      }\r\n    };\r\n\r\n    TextBinding.prototype.sync = function() {\r\n      return TextBinding.__super__.sync.apply(this, arguments);\r\n    };\r\n\r\n    return TextBinding;\r\n\r\n  })(Rivets.Binding);\r\n\r\n  return {\r\n    Binding : Rivets.Binding,\r\n    ComponentBinding: Rivets.ComponentBinding,\r\n    TextBinding: Rivets.TextBinding\r\n  };\r\n});\r\n"]}