/**
 * skylark-rivets - A version of rivets.js that ported to running on skylarkjs.
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylark-integration/skylark-rivets/
 * @license MIT
 */
define(["./rivets"],function(e){var t=[].indexOf;return e.public.adapters["."]={id:"_rv",counter:0,weakmap:{},weakReference:function(e){var t,n,i;return e.hasOwnProperty(this.id)||(t=this.counter++,Object.defineProperty(e,this.id,{value:t})),(n=this.weakmap)[i=e[this.id]]||(n[i]={callbacks:{}})},cleanupWeakReference:function(e,t){if(!(Object.keys(e.callbacks).length||e.pointers&&Object.keys(e.pointers).length))return delete this.weakmap[t]},stubFunction:function(e,t){var n,i,r;return i=e[t],n=this.weakReference(e),r=this.weakmap,e[t]=function(){var t,s,a,u,l,c,o,f,p;for(s in a=i.apply(e,arguments),c=n.pointers)for(t=c[s],u=0,l=(p=null!=(o=null!=(f=r[s])?f.callbacks[t]:void 0)?o:[]).length;u<l;u++)(0,p[u])();return a}},observeMutations:function(e,n,i){var r,s,a,u,l,c;if(Array.isArray(e)){if(null==(a=this.weakReference(e)).pointers)for(a.pointers={},l=0,c=(s=["push","pop","shift","unshift","sort","reverse","splice"]).length;l<c;l++)r=s[l],this.stubFunction(e,r);if(null==(u=a.pointers)[n]&&(u[n]=[]),t.call(a.pointers[n],i)<0)return a.pointers[n].push(i)}},unobserveMutations:function(e,t,n){var i,r,s;if(Array.isArray(e)&&null!=e[this.id]&&(r=this.weakmap[e[this.id]])&&(s=r.pointers[t]))return(i=s.indexOf(n))>=0&&s.splice(i,1),s.length||delete r.pointers[t],this.cleanupWeakReference(r,e[this.id])},observe:function(e,n,i){var r,s,a,u;return null==(r=this.weakReference(e).callbacks)[n]&&(r[n]=[],(null!=(s=Object.getOwnPropertyDescriptor(e,n))?s.get:void 0)||(null!=s?s.set:void 0)||(a=e[n],Object.defineProperty(e,n,{enumerable:!0,get:function(){return a},set:(u=this,function(i){var s,l,c,o,f;if(i!==a&&(u.unobserveMutations(a,e[u.id],n),a=i,l=u.weakmap[e[u.id]])){if((r=l.callbacks)[n])for(c=0,o=(f=r[n].slice()).length;c<o;c++)s=f[c],t.call(r[n],s)>=0&&s();return u.observeMutations(i,e[u.id],n)}})}))),t.call(r[n],i)<0&&r[n].push(i),this.observeMutations(e[n],e[this.id],n)},unobserve:function(e,t,n){var i,r,s;if((s=this.weakmap[e[this.id]])&&(i=s.callbacks[t]))return(r=i.indexOf(n))>=0&&(i.splice(r,1),i.length||(delete s.callbacks[t],this.unobserveMutations(e[t],e[this.id],t))),this.cleanupWeakReference(s,e[this.id])},get:function(e,t){return e[t]},set:function(e,t,n){return e[t]=n}},e.public.adapters});
//# sourceMappingURL=sourcemaps/adapter.js.map
